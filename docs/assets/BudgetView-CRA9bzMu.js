import{d as _,p,r as m,q as N,w as j,c as l,a as t,h as A,s as S,g as B,y as O,F as V,i as F,k as E,j as H,v as L,t as f,o as i}from"./index-Da3oJxeQ.js";import{u as D}from"./useAuth-4u8PwluR.js";import{u as T}from"./useSubscriptionsMongo-CIVDhvot.js";const q={class:"min-h-screen p-6",style:{"background-color":"var(--bg-page)",color:"var(--text-main)"}},z={class:"flex justify-between items-center mb-10"},G={class:"space-y-4"},I={class:"font-medium"},P={class:"font-mono text-sm",style:{color:"var(--muted)"}},$={class:"card p-6 rounded-xl w-full max-w-sm"},W=_({__name:"BudgetView",setup(J){const{user:d}=D(),{subscriptions:g,fetchSubscriptions:h,categories:v,fetchCategories:y,createCategory:w}=T(),x=p(()=>{const s={Financial:[],Shopping:[],Education:[],Health:[],Other:[]};for(const e of g.value){const n=k(e.category);s[n]?s[n].push(e):s.Other&&s.Other.push(e)}return s}),b=p(()=>v.value.map(s=>{const e=x.value[s.name]||[],n=e.reduce((o,a)=>a.cycle==="monthly"?o+a.price:a.cycle==="yearly"?o+a.price/12:o,0);return{...s,total:n,subscriptions:e}})),k=s=>{const e={streaming:"Streaming",music:"Music",games:"Games",education:"Education",health:"Health",work:"Productivity",financial:"Finance",shopping:"Shopping",other:"Other"};return s&&s in e?e[s]??"Other":"Other"},u=m(!1),r=m(""),C=()=>{r.value="",u.value=!0},c=()=>{u.value=!1},M=async()=>{r.value.trim()!==""&&d.value&&(await w({name:r.value,userId:d.value.uid}),c())};return N(()=>{j(d,s=>{s?.uid&&(h(s.uid),y(s.uid))},{immediate:!0})}),(s,e)=>{const n=O("router-link");return i(),l("div",q,[t("header",z,[S(n,{to:"/dashboard",class:"p-2 rounded-full transition-colors hover:bg-black/5"},{default:B(()=>[...e[1]||(e[1]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",class:"stroke-current"},[t("path",{d:"M15 18L9 12L15 6","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])]),_:1}),e[2]||(e[2]=t("h1",{class:"text-xl font-semibold"},"Add Subscription",-1)),e[3]||(e[3]=t("div",{class:"w-10 h-10"},null,-1))]),t("main",null,[e[5]||(e[5]=t("div",{class:"text-left mb-8"},[t("h2",{class:"text-4xl font-bold"},"Add your"),t("h2",{class:"text-4xl font-bold",style:{color:"var(--muted)"}},"Budget Category")],-1)),t("div",G,[(i(!0),l(V,null,F(b.value,o=>(i(),l("div",{key:o.name,class:"flex justify-between items-center p-4 rounded-xl",style:{"background-color":"var(--bg-paper)"}},[t("span",I,f(o.name),1),t("span",P,"$"+f(o.total.toFixed(2)),1)]))),128)),t("div",{onClick:C,class:"flex justify-center items-center p-4 rounded-xl cursor-pointer",style:{"background-color":"var(--bg-paper-muted)"}},[...e[4]||(e[4]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",class:"stroke-current"},[t("path",{d:"M12 6V18M6 12H18","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])])])]),u.value?(i(),l("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:E(c,["self"])},[t("div",$,[e[6]||(e[6]=t("h3",{class:"text-lg font-semibold mb-4"},"Add New Category",-1)),H(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>r.value=o),type:"text",placeholder:"Category Name",class:"form-input w-full mb-4"},null,512),[[L,r.value]]),t("div",{class:"flex justify-end space-x-4"},[t("button",{onClick:c,class:"btn-secondary"},"Cancel"),t("button",{onClick:M,class:"btn-primary"},"Add")])])])):A("",!0)])}}});export{W as default};
